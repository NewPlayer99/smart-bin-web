// Firebase imports (via CDN)
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-database.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDWoRPJQ7GDlPV6Gg5Ozevsb0gHvyF6NhE",
  authDomain: "smart-recycling-bin-5bc39.firebaseapp.com",
  databaseURL: "https://smart-recycling-bin-5bc39-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "smart-recycling-bin-5bc39",
  storageBucket: "smart-recycling-bin-5bc39.appspot.com",
  messagingSenderId: "629524361345",
  appId: "1:629524361345:web:3fcb38929e5942fd705d80",
  measurementId: "G-16E48309L1"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// UID path (you can update this based on your ESP32 logic)
const userId = "wankmal_gmail_com";  // <-- Replace with currentUserPath from ESP32
const binPath = `users/${userId}/bin`;

// Read data from Firebase
onValue(ref(db, binPath), (snapshot) => {
  const data = snapshot.val();
  if (data) {
    document.getElementById("weight1").innerText = data.weight1 ?? 0;
    document.getElementById("weight2").innerText = data.weight2 ?? 0;
    document.getElementById("weight3").innerText = data.weight3 ?? 0;
    document.getElementById("totalWeight").innerText = data.totalWeight ?? 0;
    document.getElementById("reward").innerText = data.reward?.toFixed(2) ?? "0.00";
  }
});
